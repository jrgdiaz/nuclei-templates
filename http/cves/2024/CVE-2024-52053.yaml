id: wowza-version-cve-2024-52053

info:
  name: Wowza Streaming Engine ≤ 4.9.0 - Version Disclosure & CVE-2024-52053 Detection
  author: ddiax @ https://github.com/jrgdiaz
  severity: high
  description: |
    Detects Wowza Streaming Engine version disclosure via /ServerVersion on port 1935 using plain HTTP.
    If the extracted version is ≤ 4.9.0, the instance is likely vulnerable to CVE-2024-52053.
  reference:
    - https://www.rapid7.com/blog/post/2024/11/20/multiple-vulnerabilities-in-wowza-streaming-engine-fixed/
    - https://www.wowza.com/docs/wowza-streaming-engine-4-9-1-release-notes#detailed-list-of-changes-in-wowza-streaming-engine-4-9-1
    - https://www.wiz.io/vulnerability-database/cve/cve-2024-52053
  metadata:
    max-request: 1
    shodan-query: http.title:"Wowza Streaming Engine"
  tags: cve,cve2024,wowza,version-disclosure,xss

http:
  - method: GET
    path:
      - http://{{Hostname}}:1935/ServerVersion

    extractors:
      - type: regex
        part: body
        name: version
        group: 1
        regex:
          - "Wowza Streaming Engine.*?([0-9]+\\.[0-9]+\\.[0-9]+)"

    matchers:
      - type: regex
        name: vulnerable
        part: body
        regex:
          - "Wowza Streaming Engine.*?(4\\.[0-9]\\.[0-9]+|3\\.[0-9]\\.[0-9]+)"
